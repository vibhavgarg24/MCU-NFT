// SPDX-License-Identifier: UNLICENSED

pragma solidity ^0.8.0;

import "@openzeppelin/contracts/utils/Strings.sol";
import "@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol";
import "@openzeppelin/contracts/utils/Counters.sol";
import "hardhat/console.sol";
import { Base64 } from "./libraries/Base64.sol";

contract MyEpicNFT is ERC721URIStorage {
  using Counters for Counters.Counter;
  Counters.Counter private _tokenIds;

  string baseSvg = "<svg xmlns='http://www.w3.org/2000/svg' preserveAspectRatio='xMinYMin meet' viewBox='0 0 350 350'><rect width='100%' height='100%'/><svg xmlns='http://www.w3.org/2000/svg' width='500' height='70' viewBox='0 0 350 160'><g fill-rule='evenodd'><path d='M0 80v80h400V0H0v80m43.282-66.958c.086.114.324 1.333.529 2.708.205 1.375.558 3.662.784 5.083l.583 3.667.333 2.083c.089.55.306 1.938.482 3.084.177 1.146.516 3.32.754 4.833.499 3.166.978 6.224 1.424 9.083a4051.22 4051.22 0 0 0 1.425 9.084c.559 3.518.741 4.681 1.07 6.833.189 1.237.452 2.925.584 3.75.259 1.624.603 3.809 1.004 6.375.356 2.276.521 3.319.901 5.708.183 1.146.458 2.909.613 3.917.363 2.375.475 2.554.716 1.147l.352-2.064c.086-.504.306-1.854.489-3l.837-5.25c.278-1.741.546-3.466.596-3.833a31.2 31.2 0 0 1 .236-1.417c.079-.412.228-1.312.33-2 .174-1.179.281-1.833.673-4.125.09-.527.276-1.67.412-2.541l.589-3.75.512-3.25c.187-1.192.402-2.491.656-3.959a1141.03 1141.03 0 0 0 1.509-9.375c.439-2.806.612-3.886.832-5.208.096-.573.241-1.492.322-2.042.081-.55.264-1.675.406-2.5.35-2.032 1.324-8.119 1.773-11.083.091-.596.225-1.308.299-1.583l.134-.5H96.25l.084 61.25c.046 33.687.102 61.071.125 60.852.022-.218.113-.668.201-1 .087-.331.315-1.652.505-2.936a676.7 676.7 0 0 1 .507-3.375l.328-2.125.331-2.125c.091-.573.472-3.104.847-5.625.376-2.52.752-5.033.837-5.583.085-.55.224-1.487.308-2.083.085-.596.427-2.884.76-5.084.776-5.126.871-5.757 1.077-7.166.093-.642.241-1.617.327-2.167.085-.55.242-1.562.346-2.25l.331-2.167c.078-.504.299-2.004.492-3.333.193-1.329.502-3.392.687-4.583l.496-3.209c.089-.573.236-1.51.328-2.083.092-.573.581-3.854 1.086-7.292.505-3.437.993-6.7 1.085-7.25.194-1.163.744-4.778 1.001-6.583.098-.687.249-1.663.336-2.167.087-.504.227-1.441.312-2.083.085-.642.311-2.179.503-3.417.191-1.237.427-2.775.524-3.416a567.417 567.417 0 0 0 .896-6c.238-1.65.541-3.638.672-4.417.131-.779.435-2.767.675-4.417.24-1.65.5-3.412.578-3.916l.309-2c.092-.596.36-2.396.596-4 .418-2.836.735-4.9 1.109-7.209l.182-1.126 16.188.042 16.188.043.131.75c.072.412.243 1.537.381 2.5.137.962.323 2.2.413 2.75.22 1.341.576 3.67.995 6.5.19 1.283.418 2.783.506 3.333.088.55.313 2.05.5 3.333.188 1.284.412 2.784.498 3.334.087.55.275 1.787.419 2.75.27 1.807.464 3.076.747 4.875a673.1 673.1 0 0 1 1.18 7.791c.136 1.005.821 5.552 1.154 7.667.08.504.306 2.004.502 3.333.396 2.677.541 3.631.921 6.084.142.916.366 2.416.498 3.333.132.917.355 2.417.496 3.333.141.917.336 2.192.433 2.834.097.641.247 1.616.332 2.166.086.55.225 1.488.308 2.084.205 1.465 1.463 9.835 1.666 11.083.333 2.044.515 3.226.847 5.5.188 1.283.414 2.783.504 3.333.089.55.277 1.788.418 2.75.14.963.325 2.2.411 2.75.086.55.387 2.538.669 4.417.282 1.879.657 4.354.833 5.5.177 1.146.669 4.446 1.095 7.333.815 5.535.857 5.768 1.002 5.624.05-.051.142-26.405.204-58.566l.113-58.474 13.584-.053c13.727-.054 14.762-.021 18.416.573 11.098 1.806 20.424 8.561 27.157 19.671.721 1.19.718 1.15-.576-9.124a2524.66 2524.66 0 0 1-1.281-10.276l-.096-.875h24.687l.09.459c.049.252.134.833.187 1.291.053.459.166 1.284.251 1.834.085.55.267 1.862.406 2.916.138 1.054.478 3.567.756 5.584.277 2.016.655 4.791.84 6.166.185 1.375.407 2.988.494 3.584a1891.99 1891.99 0 0 1 2.003 14.75c.085.641.308 2.291.498 3.666.189 1.375.456 3.363.592 4.417.137 1.054.509 3.792.827 6.083.318 2.292.657 4.767.754 5.5.098.734.245 1.784.328 2.334.083.55.23 1.6.327 2.333.097.733.479 3.546.848 6.25.37 2.704.74 5.442.823 6.083.082.642.262 1.954.4 2.917.137.962.345 2.453.46 3.311.303 2.243.398 1.779 1.814-8.894.098-.734.247-1.784.332-2.334.085-.55.23-1.562.323-2.25.093-.687.278-2.037.411-3 .133-.962.402-2.912.596-4.333.195-1.421.494-3.596.666-4.833.487-3.512.96-6.976 1.412-10.334.228-1.696.491-3.608.586-4.25.26-1.776.776-5.481 1.253-9 .236-1.741.571-4.179.745-5.416.174-1.238.471-3.375.661-4.75l.83-6c.267-1.925.763-5.6 1.102-8.167.34-2.567.686-4.948.771-5.292l.153-.625 34.202.042 34.202.042V37.25l-10.834.083-10.833.084v30.166l10.833.084 10.834.083.042 12.207.043 12.207-10.876.043-10.876.043v30.667l10.833.083 10.834.083v24l-22.907.043c-18.215.033-22.933-.001-23.039-.167-.073-.115-.134-27.04-.135-59.834-.002-32.794-.063-59.625-.136-59.625-.073 0-.267.881-.43 1.958a302.325 302.325 0 0 1-.532 3.375 2116.81 2116.81 0 0 0-1.735 10.834c-.284 1.787-.624 3.925-.757 4.75-.338 2.104-1.006 6.278-1.407 8.791-.186 1.169-.494 3.082-.684 4.25a708.09 708.09 0 0 0-.744 4.709 598.79 598.79 0 0 1-.739 4.666 524.75 524.75 0 0 0-.496 3.084 5587.84 5587.84 0 0 1-2.174 13.666c-.724 4.472-1.495 9.294-1.827 11.417a801.84 801.84 0 0 1-.676 4.25c-.178 1.1-.592 3.688-.919 5.75-.628 3.954-1.031 6.487-1.58 9.917-.871 5.441-1.029 6.435-1.249 7.833-.305 1.936-.814 5.118-1.238 7.75-.185 1.146-.527 3.283-.76 4.75l-.817 5.137c-.216 1.358-.459 2.534-.539 2.612-.219.212-28.024.274-28.235.063-.094-.094-.428-1.703-.742-3.575l-1.742-10.404c-.645-3.85-1.245-7.412-1.335-7.916a127.4 127.4 0 0 1-.347-2.084 79.96 79.96 0 0 0-.325-1.916 82.964 82.964 0 0 1-.329-1.917c-.102-.642-.302-1.842-.443-2.667a841.217 841.217 0 0 1-1.237-7.333 122.94 122.94 0 0 0-.326-1.958l-.338-1.917c-.093-.527-.238-1.408-.322-1.958-.084-.55-.499-3.025-.924-5.5a1051.55 1051.55 0 0 1-.918-5.417c-.145-.906-.279-1.701-1.107-6.583-.233-1.375-.601-3.588-.818-4.917a271.034 271.034 0 0 0-.577-3.417c-.1-.55-.256-1.45-.346-2l-.315-1.916c-1.534-9.358-1.789-10.233-1.828-6.282-.025 2.511-.994 6.951-2.273 10.412-2.312 6.253-6.744 12.701-11.377 16.547l-.891.739.587 2c.323 1.1.86 2.938 1.193 4.084.334 1.146.867 2.945 1.184 4 .317 1.054.658 2.216.758 2.583.1.367.243.854.318 1.083.075.23.376 1.242.67 2.25.293 1.009.68 2.321.86 2.917.179.596.613 2.058.965 3.25.351 1.192 1.139 3.854 1.75 5.917.611 2.062 1.362 4.612 1.668 5.666.307 1.054.781 2.667 1.055 3.584 1.173 3.937 2.731 9.205 2.858 9.666.076.275.378 1.288.671 2.25.294.963.571 1.994.616 2.292l.081.542h-11.845c-11.164 0-11.855-.017-12.004-.295-.15-.281-.566-1.766-1.436-5.122-.214-.825-.668-2.55-1.009-3.833-.655-2.466-1.502-5.675-2.156-8.167a1819.77 1819.77 0 0 0-1.757-6.667c-.348-1.301-.534-2.005-1.386-5.25-1.028-3.91-1.275-4.847-1.669-6.333a1985.12 1985.12 0 0 1-1.852-7.049c-.21-.806-.429-1.513-.486-1.571-.099-.098-3.639.33-4.936.597l-.583.12-.084 21.743-.083 21.743-23.046.043-23.045.042-.139-.376c-.077-.206-.265-1.313-.418-2.459a228.302 228.302 0 0 0-.43-3.083c-.166-1.081-.198-1.314-1.09-7.917-.328-2.429-.689-4.941-.802-5.583l-.204-1.167H121.75l-.193 1.167c-.106.642-.32 2.142-.475 3.333-.424 3.243-.527 4.003-.809 5.917-.141.962-.492 3.512-.779 5.667-.287 2.154-.58 4.029-.651 4.166-.114.22-2.931.255-23.569.293l-23.441.042.006-.542c.09-8.285-.131-61.965-.256-61.981-.091-.012-.443 1.619-.781 3.625-.338 2.006-1.035 6.122-1.549 9.147-1.032 6.077-2.218 13.094-4.338 25.666-.773 4.584-1.674 9.909-2.003 11.834a893.89 893.89 0 0 0-.733 4.333c-.819 5.07-1.266 7.535-1.396 7.708-.121.161-1.615.209-6.474.209h-6.317l-.166-.437c-.091-.24-.249-.971-.35-1.625-.246-1.596-.312-1.986-1.214-7.188-.429-2.475-.847-4.913-.929-5.417a116.3 116.3 0 0 0-.333-1.917c-.101-.55-.25-1.412-.331-1.916-.082-.505-.346-2.042-.587-3.417a236.34 236.34 0 0 1-.592-3.5 76.337 76.337 0 0 0-.322-1.917c-.093-.504-.239-1.329-.326-1.833-.087-.504-.316-1.817-.509-2.917-.193-1.1-.418-2.412-.5-2.916-.082-.505-.337-2.005-.566-3.334-.229-1.329-.716-4.179-1.083-6.333s-.859-5.004-1.094-6.333c-.235-1.33-.501-2.904-.59-3.5-.09-.596-.319-1.946-.51-3-.19-1.055-.425-2.404-.522-3-.357-2.2-.411-2.422-.525-2.167-.061.137-.129 14.275-.152 31.417l-.041 31.166H12.417l-.043-66.916c-.023-36.805-.007-67.011.036-67.125.063-.165 3.296-.209 15.398-.209 12.06 0 15.351.045 15.474.209M367 67.917l.083 55 10.25.083 10.25.083v24l-22.323.043c-17.748.033-22.35-.001-22.456-.167-.16-.252-.185-133.856-.025-134.016.062-.061 5.518-.093 12.125-.069l12.013.043.083 55M189.944 36.944c-.061.062-.111 9.774-.111 21.584V80h.445c3.132 0 6.805-1.743 9.624-4.566 2.448-2.451 3.786-4.871 5.267-9.524.762-2.396 1.084-9.336.591-12.743-1.189-8.227-4.947-13.467-11.167-15.573-1.659-.561-4.359-.939-4.649-.65m-58.733 12.389c-.098.23-.265 1.242-.371 2.25a162.773 162.773 0 0 1-.353 3.084c-.205 1.597-1.782 15.119-2.828 24.25-.178 1.558-.402 3.47-.498 4.25-.095.779-.241 2.016-.323 2.75a712.75 712.75 0 0 1-.337 2.916c-.43 3.65-.685 5.833-.837 7.167a835.718 835.718 0 0 1-.701 5.917c-.11.916-.204 2.004-.207 2.416l-.006.75 6.629.044c5.649.037 6.644.008 6.722-.197.08-.208-.121-2.078-.765-7.097-.176-1.373-.298-2.38-.916-7.583a1040.3 1040.3 0 0 0-.595-4.917 676.126 676.126 0 0 1-.658-5.416c-.097-.825-.249-2.063-.338-2.75-.205-1.581-.88-7.197-1.323-11a483.007 483.007 0 0 0-.5-4.167c-.089-.687-.233-1.85-.322-2.583-.188-1.561-.41-3.373-.922-7.5-.309-2.487-.403-2.929-.551-2.584' fill='#040404'/><path d='M12.41 13.042c-.043.114-.059 30.32-.036 67.125l.043 66.916H36.75l.041-31.166c.023-17.142.091-31.28.152-31.417.114-.255.168-.033.525 2.167.097.596.332 1.945.522 3 .191 1.054.42 2.404.51 3 .089.596.355 2.17.59 3.5.235 1.329.727 4.179 1.094 6.333.367 2.154.854 5.004 1.083 6.333.229 1.329.484 2.829.566 3.334.082.504.307 1.816.5 2.916.193 1.1.422 2.413.509 2.917.087.504.233 1.329.326 1.833s.238 1.367.322 1.917c.084.55.351 2.125.592 3.5s.505 2.912.587 3.417c.081.504.23 1.366.331 1.916.101.55.251 1.413.333 1.917.082.504.5 2.942.929 5.417.902 5.202.968 5.592 1.214 7.188.101.654.259 1.385.35 1.625l.166.437h6.317c4.859 0 6.353-.048 6.474-.209.13-.173.577-2.638 1.396-7.708.074-.458.404-2.408.733-4.333.329-1.925 1.23-7.25 2.003-11.834 2.12-12.572 3.306-19.589 4.338-25.666.514-3.025 1.211-7.141 1.549-9.147.338-2.006.69-3.637.781-3.625.125.016.346 53.696.256 61.981l-.006.542 23.441-.042c20.638-.038 23.455-.073 23.569-.293.071-.137.364-2.012.651-4.166.287-2.155.638-4.705.779-5.667.282-1.914.385-2.674.809-5.917.155-1.191.369-2.691.475-3.333l.193-1.167h18.826l.204 1.167c.113.642.474 3.154.802 5.583.892 6.603.924 6.836 1.09 7.917.084.55.277 1.938.43 3.083.153 1.146.341 2.253.418 2.459l.139.376 23.045-.042 23.046-.043.083-21.743.084-21.743.583-.12c1.297-.267 4.837-.695 4.936-.597.057.058.276.765.486 1.571a1985.12 1985.12 0 0 0 1.852 7.049c.394 1.486.641 2.423 1.669 6.333.852 3.245 1.038 3.949 1.386 5.25.33 1.237.768 2.898 1.757 6.667.654 2.492 1.501 5.701 2.156 8.167.341 1.283.795 3.008 1.009 3.833.87 3.356 1.286 4.841 1.436 5.122.149.278.84.295 12.004.295h11.845l-.081-.542c-.045-.298-.322-1.329-.616-2.292-.293-.962-.595-1.975-.671-2.25-.127-.461-1.685-5.729-2.858-9.666-.274-.917-.748-2.53-1.055-3.584-.306-1.054-1.057-3.604-1.668-5.666-.611-2.063-1.399-4.725-1.75-5.917a988.675 988.675 0 0 0-.965-3.25c-.18-.596-.567-1.908-.86-2.917-.294-1.008-.595-2.02-.67-2.25a28.275 28.275 0 0 1-.318-1.083c-.1-.367-.441-1.529-.758-2.583-.317-1.055-.85-2.854-1.184-4-.333-1.146-.87-2.984-1.193-4.084l-.587-2 .891-.739c6.262-5.199 11.277-13.82 13.046-22.427.372-1.81.593-3.472.604-4.532.039-3.951.294-3.076 1.828 6.282l.315 1.916c.09.55.246 1.45.346 2 .1.55.36 2.088.577 3.417.217 1.329.585 3.542.818 4.917.828 4.882.962 5.677 1.107 6.583.081.504.494 2.942.918 5.417.425 2.475.84 4.95.924 5.5.084.55.229 1.431.322 1.958l.338 1.917c.093.527.24 1.408.326 1.958.146.925.612 3.69 1.237 7.333.141.825.341 2.025.443 2.667.103.642.25 1.504.329 1.917.078.412.224 1.275.325 1.916.101.642.257 1.579.347 2.084.09.504.69 4.066 1.335 7.916l1.742 10.404c.314 1.872.648 3.481.742 3.575.211.211 28.016.149 28.235-.063.08-.078.323-1.254.539-2.612l.817-5.137c.233-1.467.575-3.604.76-4.75.424-2.632.933-5.814 1.238-7.75.22-1.398.378-2.392 1.249-7.833.549-3.43.952-5.963 1.58-9.917.327-2.062.741-4.65.919-5.75.179-1.1.483-3.013.676-4.25.332-2.123 1.103-6.945 1.827-11.417a5587.84 5587.84 0 0 0 2.174-13.666c.085-.55.309-1.938.496-3.084.188-1.145.52-3.246.739-4.666.219-1.421.554-3.54.744-4.709.19-1.168.498-3.081.684-4.25.401-2.513 1.069-6.687 1.407-8.791.133-.825.473-2.963.757-4.75a2116.81 2116.81 0 0 1 1.735-10.834c.129-.779.369-2.298.532-3.375.163-1.077.357-1.958.43-1.958.073 0 .134 26.831.136 59.625.001 32.794.062 59.719.135 59.834.106.166 4.824.2 23.039.167l22.907-.043v-24L327.583 123l-10.833-.083V92.25l10.876-.043 10.876-.043-.043-12.207-.042-12.207-10.834-.083-10.833-.084V37.417l10.833-.084 10.834-.083V12.917l-34.202-.042-34.202-.042-.153.625c-.085.344-.431 2.725-.771 5.292-.339 2.567-.835 6.242-1.102 8.167l-.83 6c-.19 1.375-.487 3.512-.661 4.75-.174 1.237-.509 3.675-.745 5.416-.477 3.519-.993 7.224-1.253 9-.095.642-.358 2.554-.586 4.25-.452 3.358-.925 6.822-1.412 10.334-.172 1.237-.471 3.412-.666 4.833-.194 1.421-.463 3.371-.596 4.333-.133.963-.318 2.313-.411 3-.093.688-.238 1.7-.323 2.25-.085.55-.234 1.6-.332 2.334-1.416 10.673-1.511 11.137-1.814 8.894-.115-.858-.323-2.349-.46-3.311-.138-.963-.318-2.275-.4-2.917-.083-.641-.453-3.379-.823-6.083-.369-2.704-.751-5.517-.848-6.25-.097-.733-.244-1.783-.327-2.333-.083-.55-.23-1.6-.328-2.334-.097-.733-.436-3.208-.754-5.5-.318-2.291-.69-5.029-.827-6.083a667.459 667.459 0 0 0-.592-4.417c-.19-1.375-.413-3.025-.498-3.666a1891.99 1891.99 0 0 0-2.003-14.75 457.43 457.43 0 0 1-.494-3.584c-.185-1.375-.563-4.15-.84-6.166-.278-2.017-.618-4.53-.756-5.584a177.373 177.373 0 0 0-.406-2.916 58.898 58.898 0 0 1-.251-1.834 21.88 21.88 0 0 0-.187-1.291l-.09-.459h-24.687l.096.875c.054.482.63 5.106 1.281 10.276 1.294 10.274 1.297 10.314.576 9.124-6.733-11.11-16.059-17.865-27.157-19.671-3.654-.594-4.689-.627-18.416-.573l-13.584.053-.113 58.474c-.062 32.161-.154 58.515-.204 58.566-.145.144-.187-.089-1.002-5.624-.426-2.887-.918-6.187-1.095-7.333-.176-1.146-.551-3.621-.833-5.5a1207.05 1207.05 0 0 0-.669-4.417c-.086-.55-.271-1.787-.411-2.75-.141-.962-.329-2.2-.418-2.75-.09-.55-.316-2.05-.504-3.333a286.508 286.508 0 0 0-.847-5.5c-.203-1.248-1.461-9.618-1.666-11.083-.083-.596-.222-1.534-.308-2.084-.085-.55-.235-1.525-.332-2.166-.097-.642-.292-1.917-.433-2.834-.141-.916-.364-2.416-.496-3.333-.132-.917-.356-2.417-.498-3.333-.38-2.453-.525-3.407-.921-6.084a447.85 447.85 0 0 0-.502-3.333 669.045 669.045 0 0 1-1.154-7.667 673.1 673.1 0 0 0-1.18-7.791 576.594 576.594 0 0 1-.747-4.875c-.144-.963-.332-2.2-.419-2.75-.086-.55-.31-2.05-.498-3.334a339.84 339.84 0 0 0-.5-3.333c-.088-.55-.316-2.05-.506-3.333-.419-2.83-.775-5.159-.995-6.5-.09-.55-.276-1.788-.413-2.75-.138-.963-.309-2.088-.381-2.5l-.131-.75-16.188-.043-16.188-.042-.182 1.126a482.563 482.563 0 0 0-1.109 7.209 858.429 858.429 0 0 1-.596 4l-.309 2a702.99 702.99 0 0 0-.578 3.916c-.24 1.65-.544 3.638-.675 4.417-.131.779-.434 2.767-.672 4.417a567.417 567.417 0 0 1-.896 6c-.097.641-.333 2.179-.524 3.416a205.017 205.017 0 0 0-.503 3.417 65.805 65.805 0 0 1-.312 2.083c-.087.504-.238 1.48-.336 2.167-.257 1.805-.807 5.42-1.001 6.583-.092.55-.58 3.813-1.085 7.25-.505 3.438-.994 6.719-1.086 7.292-.092.573-.239 1.51-.328 2.083l-.496 3.209a570.297 570.297 0 0 0-.687 4.583 544.54 544.54 0 0 1-.492 3.333l-.331 2.167c-.104.688-.261 1.7-.346 2.25-.086.55-.234 1.525-.327 2.167-.206 1.409-.301 2.04-1.077 7.166-.333 2.2-.675 4.488-.76 5.084-.084.596-.223 1.533-.308 2.083-.085.55-.461 3.063-.837 5.583a1090.86 1090.86 0 0 1-.847 5.625L98 125.583l-.328 2.125a676.7 676.7 0 0 0-.507 3.375c-.19 1.284-.418 2.605-.505 2.936a8.149 8.149 0 0 0-.201 1c-.023.219-.079-27.165-.125-60.852l-.084-61.25H65.441l-.134.5c-.074.275-.208.987-.299 1.583a845.573 845.573 0 0 1-1.773 11.083c-.142.825-.325 1.95-.406 2.5-.081.55-.226 1.469-.322 2.042a495.83 495.83 0 0 0-.832 5.208c-.487 3.106-1.31 8.22-1.509 9.375a255.136 255.136 0 0 0-.656 3.959l-.512 3.25-.589 3.75c-.136.871-.322 2.014-.412 2.541-.392 2.292-.499 2.946-.673 4.125a60.948 60.948 0 0 1-.33 2 31.2 31.2 0 0 0-.236 1.417c-.05.367-.318 2.092-.596 3.833l-.837 5.25a397.63 397.63 0 0 1-.489 3l-.352 2.064c-.241 1.407-.353 1.228-.716-1.147-.155-1.008-.43-2.771-.613-3.917-.38-2.389-.545-3.432-.901-5.708a2184.12 2184.12 0 0 0-1.004-6.375c-.132-.825-.395-2.513-.584-3.75a980.192 980.192 0 0 0-1.07-6.833 4051.22 4051.22 0 0 1-1.425-9.084c-.446-2.859-.925-5.917-1.424-9.083-.238-1.513-.577-3.687-.754-4.833a523.387 523.387 0 0 0-.482-3.084l-.333-2.083-.583-3.667a641.571 641.571 0 0 1-.784-5.083c-.205-1.375-.443-2.594-.529-2.708-.123-.164-3.414-.209-15.474-.209-12.102 0-15.335.044-15.398.209m330.369-.099c-.16.16-.135 133.764.025 134.016.106.166 4.708.2 22.456.167l22.323-.043v-24l-10.25-.083-10.25-.083-.083-55-.083-55-12.013-.043c-6.607-.024-12.063.008-12.125.069m-150.27 24.131c6.529 1.25 11.051 5.981 12.753 13.343 1.011 4.375.964 12.169-.093 15.493-1.481 4.653-2.819 7.073-5.267 9.524-2.819 2.823-6.492 4.566-9.624 4.566h-.445V58.528c0-11.81.05-21.522.111-21.584.181-.18 1.218-.127 2.565.13M132.329 56.5c.107.871.267 2.183.355 2.917.089.733.233 1.896.322 2.583.088.688.314 2.563.5 4.167.443 3.803 1.118 9.419 1.323 11 .089.687.241 1.925.338 2.75.209 1.783.416 3.483.658 5.416.098.779.366 2.992.595 4.917.618 5.203.74 6.21.916 7.583.644 5.019.845 6.889.765 7.097-.078.205-1.073.234-6.722.197l-6.629-.044.006-.75c.003-.412.097-1.5.207-2.416.394-3.268.542-4.519.701-5.917.152-1.334.407-3.517.837-7.167.103-.871.254-2.183.337-2.916.082-.734.228-1.971.323-2.75.096-.78.32-2.692.498-4.25 1.046-9.131 2.623-22.653 2.828-24.25.089-.688.247-2.075.353-3.084.401-3.817.421-3.751 1.489 4.917' fill='#fbfbfb'/></g></svg><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' style='fill:#fff;font-family:serif;font-size:45px'>";

  string[] firstWords = ["Loki", "Iron", "Winter", "Ant", "War", "Shang", "Ancient", "Wilson", "Agatha", "Ebony", "Green", "Red", "Arnim", "Helmut", "Yondu", "Sand", "Scarlet", "Captain", "Doctor", "Spider", "Thor", "Black", "Star", "Dare", "Nick", "Power"];
  string[] secondWords = ["Odinson", "Strange", "Man", "Devil", "Widow", "Machine", "Chi", "Octopus", "Skull", "Fury", "Zola", "Laufeyson", "Zemo", "Udonta", "Lord", "Soldier", "Marvel", "Panther", "Witch", "America", "One", "Harkness", "Maw", "Goblin", "Fisk", "Broker"];

    event NewEpicNFTMinted(address sender, uint256 tokenId);

  constructor() ERC721 ("MCU-NFT", "MCU") {
    console.log("NFT contract constructor");
  }

  function pickRandomFirstWord(uint256 tokenId) public view returns (string memory) {
    uint256 rand = random(string(abi.encodePacked("FIRST_WORD", Strings.toString(tokenId))));
    rand = rand % firstWords.length;
    return firstWords[rand];
  }

  function pickRandomSecondWord(uint256 tokenId) public view returns (string memory) {
    uint256 rand = random(string(abi.encodePacked("SECOND_WORD", Strings.toString(tokenId))));
    rand = rand % secondWords.length;
    return secondWords[rand];
  }

  function random(string memory input) internal pure returns (uint256) {
      return uint256(keccak256(abi.encodePacked(input)));
  }

  function makeAnEpicNFT() public {
    uint256 newItemId = _tokenIds.current();

    string memory first = pickRandomFirstWord(newItemId);
    string memory second = pickRandomSecondWord(newItemId);
    string memory combinedWord = string(abi.encodePacked(first, second));

    string memory finalSvg = string(abi.encodePacked(baseSvg, combinedWord, "</text></svg>"));
    string memory name = string(abi.encodePacked("#", Strings.toString(newItemId), " ", combinedWord));

    string memory json = Base64.encode(
        bytes(
            string(
                abi.encodePacked(
                    '{"name": "',
                    name,
                    '", "description": "A collection of unique MCU Characters generated randomly.", "image": "data:image/svg+xml;base64,',
                    Base64.encode(bytes(finalSvg)),
                    '"}'
                )
            )
        )
    );

    string memory finalTokenUri = string(
        abi.encodePacked("data:application/json;base64,", json)
    );

    console.log("\n--------------------");
    console.log(finalTokenUri);
    console.log("--------------------\n");

    _safeMint(msg.sender, newItemId);
    
    _setTokenURI(newItemId, finalTokenUri);
  
    _tokenIds.increment();
    console.log("An NFT w/ ID %s has been minted to %s", newItemId, msg.sender);

    emit NewEpicNFTMinted(msg.sender, newItemId);

  }
}